<div id="project-worklist">
	<header>
		<%= link_to "Add Item", new_worklist_item_project_path(@project), :class=>"btn btn-default pull-right", :style=>"width:24%", :remote => true %>
		<div class="input-group" style="width: 74%; margin-bottom: 20px;">
			<input type="text" class="form-control" name="query" autocomplete="off" placeholder="Search Punch Lists">
			<span class="input-group-addon" style="cursor: pointer;"><span class="glyphicon glyphicon-search"></span></span>
		</div>
	</header>	
	<table class="table table-bordered table-responsive" id="users">
		<thead>
			<tr>
				<th>Photo</th>
				<th>Name</th>
				<th>Assignment</th>
				<th>Completed</th>
				<th>Created On</th>
			</tr>
		</thead>
	
		<tbody>
			<% if @items && @items.count > 0 %>
				<% @items.each do |item| %>
					<tr>
						<td style="width:100px;">
							<% if item.photos && item.photos.count > 0 %>
								<% photo = item.photos.where("image_file_name IS NOT NULL").first %>
								<% if photo %><%=image_tag(photo.image.url(:thumb)) %><% end %>
							<% end %>
						</td>
						<td>
							<% if item.body.length > 0 %>
								<%= link_to item.body, edit_worklist_item_project_path(@project, :item_id => item.id), :remote => true %> 
							<% else %>
								<%= link_to edit_worklist_item_project_path(@project, :item_id => item.id), :remote => true do %> <div style="width:100%;display:block;">&nbsp;</div><% end %>
							<% end %>
						</td>	
						<td>
							<% if item.assignee_id %>
								<%= item.assignee.full_name %>
							<% else %>
								<span style="color:#aaa;font-style:italic;">Not yet assigned</span>
							<% end %>
						</td>
						<td>
							<% if item.completed_at %>
								<%= parse_time item.completed_at %>
							<% end %>
						</td>
						<td><%= parse_time item.created_at %></td>
					</tr>
				<% end %>
			<% else %>
				<tr><td colspan="5" class="loading"><h4 style="text-align:center;color:#aaa;font-style:italic;">No Worklist Items</h4></td></tr>
			<% end %>
		</tbody>
	</table>
</div>