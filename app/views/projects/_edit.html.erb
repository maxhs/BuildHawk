<div id="edit-project" class="border-box">
	<h3 class="edit-header">Edit Project</h3>
	<%= nested_form_for @project, :method => :put, :remote => true do |f| %>

		<%= hidden_field_tag :company_id, current_user.company.id %>
		<%= hidden_field_tag :authenticity_token, form_authenticity_token %>
		<div class="row">
			<div class="col-xs-3 project-label"><h4>Name</h4></div>
			<div class="col-xs-9"><%= f.text_field :name, :placeholder => "Project name" %></div>
		</div>
		
		<%= f.fields_for :address do |a| %>
			<div class="row">
				<div class="col-xs-3 project-label"><h4>Street</h4></div>
				<div class="col-xs-9"><%= a.text_field :street1 , :placeholder => "Street address" %></div>
			</div>
			<div class="row">
				<div class="col-xs-3 project-label"><h4>City</h4></div>
				<div class="col-xs-9"><%= a.text_field :city , :placeholder => "City" %></div>
			</div>
			<div class="row">
				<div class="col-xs-3 project-label"><h4>State</h4></div>
				<div class="col-xs-9"><%= a.text_field :state , :placeholder => "State" %></div>
			</div>
			<div class="row" style="margin-bottom:10px;">
				<div class="col-xs-3 project-label"><h4>Zip</h4></div>
				<div class="col-xs-9"><%= a.text_field :zip , :placeholder => "Zip" %></div>
			</div>
		<% end %>
		
		<% if @project_groups %>
		    <div class="row personnel">
		    	<div class="col-xs-3"><h4>Project Group</h4></div>
		    	<div class="col-xs-9"><%= f.select :project_group_id, options_for_select(@project_groups.map{|pg| [pg.name, pg.id]}.unshift("No Assignment"), selected: f.object.project_group_id), {}, :class=>"for-select-2" %></div>
		    </div>
	    <% end %>

	    <div class="row personnel">
	    	<div class="col-xs-3"><h4>Personnel Assigned</h4></div>
	    	<div class="col-xs-9" style="max-height:50%;overflow-y:scroll;padding-top:3px;">
	    		<%= f.collection_select :user_ids, @users, :id, :full_name, {selected: @project.user_ids}, {multiple: true, :class => "for-select-2", include_blank: false, include_empty: false} %>
	    	</div>
	    </div>

	    <div class="row personnel">
	    	<div class="col-xs-3"><h4>Subcontractors Assigned</h4></div>
	    	<div class="col-xs-6" style="max-height:50%;overflow-y:scroll;padding-top:3px;">
	    		<%= f.collection_select :company_ids, @subs, :id, :name, {selected: @project.company_ids}, {multiple:true, :class => "for-select-2", include_blank: false, include_empty: false} %>
	    	</div>
	    </div>

	    <% if current_user.uber_admin %>
		    <div class="row" style="margin-top:1em;">
		    	<div class="col-xs-3"><h4>Use as Demo</h4></div>
		    	<div class="col-xs-9" style="padding-top:3px;"><%= f.check_box :core %><% if f.object.core %> <span id="core-warning"> WARNING: This will make the project visible to all users</span><% end %></div>
		    </div>
		<% end %>
		
		<div class="button-section">
			<div class="button-container">
				<%= button_tag(type: 'submit', :class=> "simple-btn full-width") do %>
			    	<i class="fa fa-floppy-o"></i> Save
			  	<% end %>
	<% end %>
			</div>
			<div class="button-container">
				<% if current_user.project_users.where(:project_id => @project.id, :hidden => true).first %>
					<%= link_to "Activate", activate_project_path(@project), :method => :post, id: "hide-button", :class=>"simple-btn remote", data: {:confirm => "Are you sure you want to activate this project?"}, remote: true %>
				<% else %>
					<%= link_to "Hide", hide_project_path(@project), :method => :post, id: "hide-button", :class=>"simple-btn remote", data: {:confirm => "Are you sure you want to hide this project?"}, remote: true %>
				<% end %>
				<%= link_to "Remove", destroy_confirmation_project_path(@project), :method => :get, id:"remove-project-button", :class=>"simple-btn danger", remote: true %>
			</div>
		</div>
</div>

<script>
	$(".for-select-2").select2();
</script>