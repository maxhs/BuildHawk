<ul id="projects-sidebar" class="project-sidebar" role="navigation">
		<li id="search-section">
			<%= form_tag search_projects_path, :method => :post, :remote => true do %>
		   		<%= text_field_tag :search, params[:search], :id => "projects-search-form", :placeholder => "Search", :class=>"tt-hint form-control" %>
			<% end %>
		</li>
		
		<% if current_user.any_admin? %>
			<li class="project buttons" style="padding:0">
				<%= link_to "+ NEW PROJECT", new_project_admin_index_path, id:"new-project-button", remote: true %>
				<%= link_to "+ NEW GROUP", new_project_group_path, id:"new-group-button", :class=>"remote", remote: true %>
			</li>
		<% end %>

		<aside id="projects">
			<% if @projects && @projects.count > 0 %>
				<% @projects.each do |project| %>
					<% if project.checklist && project.checklist.item_count > 0 %>
						<li class="project">
							<%= link_to project_path(project),:id=>"#{project.id}-link",remote: true do %>
								<div class="inner-padding">
									<span class="project-name"><%= project.name %></span>
									<span class="percentage"><%= project.checklist.progress_percentage %></span>
									<div id="sidebar-progress-link-<%=project.id%>" class="sidebar-progress-link" ></div>
								</div>
							<% end %>
						</li>
					<% else %>
						<li><%= link_to project.name, project_path(project), :id=>"#{project.id}-link", :remote => true %></li>
					<% end %>
				<% end %>
			<% end %>
		
			<div id="group-container">
				<% if @project_groups && @project_groups.count > 0 %>
					<%= render partial:"project_groups/group", collection: @project_groups, as: :project_group, cache:true %>
				<% else %>
					<li style="color:#aaa;font-weight:100;">N/A</li>
				<% end %>
			</div>

			<% if @archived_projects && @archived_projects.count > 0 %>
			
				<li><h5 id="archived-projects-button">Archived Projects</h5></li>	
				<% @archived_projects.each do |p| %>
					<li class="project"><%= link_to p.name, project_path(p), :id=>"#{p.id}-link", :remote => true %></li>
				<% end %>
			
			<% end %>
	</aside>
</ul>

<div id="connect-container">
	<h5>CONNECT</h5>
	<ul id="connect-sidebar" role="navigation">
		<% if @companies && @companies.count > 0 %>
			<%= render partial:"connect/company_li", collection: @companies, as: :company, cache:true %>
		<% else %>
			<li style="color:#aaa;font-weight:100;">N/A</li>
		<% end %>
	</ul>
</div>
	
<script type="text/javascript">
	$(function(){
		sidebarSetup();
		<% if @projects %>
			<% @projects.each do |p| %>
				<% if p.checklist %>
					$('#sidebar-progress-link-<%=p.id%>').progressbar({
				    	value:<%=p.checklist.progress%>
				    });
				<% end %>
		    <% end %>
	    <% end %>
	    <% if @project_groups %>
		    <% @project_groups.each do |g| %>
		    	<% g.projects.each do |p| %>
					<% if p.checklist %>
						$('#sidebar-progress-link-<%=p.id%>').progressbar({
					    	value:<%=p.checklist.progress%>
					    });
					<% end %>
				<% end %>
		    <% end %>
	    <% end %>
	})
	$('#projects').sortable({
      	axis: 'y',
      	dropOnEmpty:true,
      	cursor: 'move',
      	items: 'li',
      	opacity: 0.6,
      	scroll: true,
      	stop: function(){
            $.ajax({
                type: 'post',
                data: $('#projects').sortable('serialize'),
                dataType: 'script',
                url: '/projects/order_projects'})
            }
    })
</script>