<div class="border-box" style="padding-top:20px;padding-bottom:0px;">
	<header>	
		<%= link_to "Add Report", new_report_path(:project_id => @project.id), :class=>"btn btn-default pull-right search-button", remote: true %>
		
		<div style="margin-bottom: 20px">
			<%= form_tag search_reports_path(:project_id => @project.id), :id => "reports-search", :method => :post, :class=>"input-group", :remote => true do %>
				<%= text_field_tag :search, nil, :placeholder=>"Search Reports...", :class=>"form-control" %>
				<span class="input-group-addon" style="cursor: pointer;" id="remove"><span class="glyphicon glyphicon-remove"></span></span>
			<% end %>
		</div>
	</header>

	<div id="project-reports">
		<table class="table table-bordered table-responsive" id="users">
			<thead>
				<tr>
					<th>Report Date</th>
					<th>Type</th>
					<th>Last Updated</th>
					<th>Photos</th>
				</tr>
			</thead>
			<tbody>
				
				<% if @reports && @reports.count > 0 %>
					<% @reports.each do |report| %>
						<tr>
							<td><%= link_to "#{report.report_type} - #{report.created_date}", report_path(report), :remote => true %></td>
							<td><%= report.report_type %></td>
							<td><% if report.updated_at %><%= parse_time report.updated_at %><% end %></td>
							<td>
								<%if report.photos && report.photos.count > 0 %>
									<% if report.photos.count == 1 %>
										1
									<% else %>
										<%= report.photos.count %>
									<% end %>
								<% else %>
									0
								<% end %>
							</td>
						</tr>
					<% end %>
				<% else %>
					<tr><td colspan="4" class="loading"><h4 style="font-weight:100;text-align:center;color:#aaa;font-style:italic;">No reports</h4></td></tr>
				<% end %>
				
			</tbody>
		</table>
	</div>
</div>
<script>
	$('#remove').click(function(){
		$('#search').val('');
		$('#reports-search').submit();
	});
</script>